{
  "hash": "7ddb8b7f6af02037beb38c88062faae7",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Gemini Data Analysis\"\nauthor: \"Robert W. Walker\"\ndate: \"2026-01-14\"\nimage: \"image.png\"\n---\n\n# TL;DR\n\nGemini is powerful, soup to nuts, in analysing data.  Let's look at an example that literally deploys a model to generate a common quantity used in portfolio management in finance.\n\n\n::: {.callout-note appearance=\"simple\"}\n\n## Prompt: \n\nPlease use publicly available sources to acquire the price of Apple common stock over the last five years and plot it as a time series.  Then proceed to calculate the monthly returns for the stock and the monthly returns for the S&P 500 and provide a CAPM regression of beta.  Finally, please allow me access to the data you used by exporting it to sheets\n\n:::\n\n# Apple (AAPL) vs S&P 500: 5-Year CAPM Analysis\n**Date Range:** January 2021 â€“ January 2026\n\n## 1. Regression Statistics (Monthly Returns)\nBased on the monthly returns of Apple stock compared to the S&P 500:\n\n* **Beta ($\\beta$):** 1.09\n* **Alpha ($\\alpha$):** 0.17% (Monthly)\n* **R-Squared ($R^2$):** 0.44\n\n## 2. Interpretation\n* **Beta (1.09):** AAPL has historically been about **9% more volatile** than the S&P 500. A 1% rise in the market typically correlates with a 1.09% rise in AAPL.\n* **Alpha (0.17%):** On average, AAPL outperformed the risk-adjusted return predicted by the CAPM model by 0.17% per month.\n* **R-Squared (0.44):** Approximately 44% of Apple's price movement can be explained by the movement of the S&P 500.\n\n## 3. Plots Generated\n* **Time Series:** A line chart showing AAPL price rising from ~$128 (Jan 2021) to ~$259 (Jan 2026).\n* **Regression:** A scatter plot of `SP500_Return` (x-axis) vs `AAPL_Return` (y-axis) with a regression line of slope 1.09.\n\n::: {#4c435253 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nfrom scipy import stats\nimport matplotlib.pyplot as plt\n\n# Data from Source 1.3 (AAPL)\naapl_text = \"\"\"\nJan 2026 | 259.89\nDec 2025 | 272.21\nNov 2025 | 278.85\nOct 2025 | 270.11\nSep 2025 | 254.38\nAug 2025 | 231.92\nJul 2025 | 207.13\nJun 2025 | 204.74\nMay 2025 | 200.43\nApr 2025 | 211.78\nMar 2025 | 221.37\nFeb 2025 | 241.02\nJan 2025 | 234.94\nDec 2024 | 249.29\nNov 2024 | 236.26\nOct 2024 | 224.65\nSep 2024 | 231.70\nAug 2024 | 227.72\nJul 2024 | 220.58\nJun 2024 | 209.20\nMay 2024 | 190.95\nApr 2024 | 168.95\nMar 2024 | 170.09\nFeb 2024 | 179.29\nJan 2024 | 182.68\nDec 2023 | 190.73\nNov 2023 | 188.17\nOct 2023 | 168.95\nSep 2023 | 169.38\nAug 2023 | 185.87\nJul 2023 | 194.09\nJun 2023 | 191.64\nMay 2023 | 175.12\nApr 2023 | 167.41\nMar 2023 | 162.70\nFeb 2023 | 145.44\nJan 2023 | 142.15\nDec 2022 | 128\nNov 2022 | 145.83\nOct 2022 | 150.81\nSep 2022 | 135.92\nAug 2022 | 154.63\nJul 2022 | 159.61\nJun 2022 | 134.28\nMay 2022 | 146.18\nApr 2022 | 154.61\nMar 2022: 171.24\nFeb 2022: 161.93\nJan 2022: 171.19\nDec 2021: 173.92\nNov 2021: 161.90\nOct 2021: 146.51\nSep 2021: 138.39\nAug 2021: 148.49\nJul 2021: 142.44\nJun 2021: 133.75\nMay 2021: 121.69\nApr 2021: 128.16\nMar 2021: 119.08\nFeb 2021: 118.22\nJan 2021: 128.46\n\"\"\"\n\n# Data from Source 2.3 (S&P 500)\nsp500_text = \"\"\"\n2026-01-09 | 6966.28\n2025-12-31 | 6845.50\n2025-11-28 | 6849.09\n2025-10-31 | 6840.20\n2025-09-30 | 6688.46\n2025-08-29 | 6460.26\n2025-07-31 | 6339.39\n2025-06-30 | 6204.95\n2025-05-30 | 5911.69\n2025-04-30 | 5569.06\n2025-03-31 | 5611.85\n2025-02-28 | 5954.50\n2025-01-31 | 6040.53\n2024-12-31 | 5881.63\n2024-11-29 | 6032.38\n2024-10-31 | 5705.45\n2024-09-30 | 5762.48\n2024-08-30 | 5648.40\n2024-07-31 | 5522.30\n2024-06-28 | 5460.48\n2024-05-31 | 5277.51\n2024-04-30 | 5035.69\n2024-03-28 | 5254.35\n2024-02-29 | 5096.27\n2024-01-31 | 4845.65\n2023-12-29 | 4769.83\n2023-11-30 | 4567.80\n2023-10-31 | 4193.80\n2023-09-29 | 4288.05\n2023-08-31 | 4507.66\n2023-07-31 | 4588.96\n2023-06-30 | 4450.38\n2023-05-31 | 4179.83\n2023-04-28 | 4169.48\n2023-03-31 | 4109.31\n2023-02-28 | 3970.15\n2023-01-31 | 4076.60\n2022-12-31 | 3839.50\n2022-11-30 | 4080.11\n2022-10-31 | 3871.98\n2022-09-30 | 3585.62\n2022-08-31 | 3955.00\n2022-07-29 | 4130.29\n2022-06-30 | 3785.38\n2022-05-31 | 4132.15\n2022-04-29 | 4131.93\n2022-03-31 | 4530.41\n2022-02-28 | 4373.94\n2022-01-31 | 4515.55\n2021-12-31 | 4766.18\n2021-11-30 | 4567.00\n2021-10-29 | 4605.38\n2021-09-30 | 4307.54\n2021-08-31 | 4522.68\n2021-07-30 | 4395.26\n2021-06-30 | 4297.50\n2021-05-28 | 4204.11\n2021-04-30 | 4181.17\n2021-03-31 | 3972.89\n2021-02-26 | 3811.15\n2021-01-29 | 3714.24\n\"\"\"\n\n# Processing AAPL\naapl_data = []\nfor line in aapl_text.strip().split('\\n'):\n    parts = line.replace(':', '|').split('|')\n    if len(parts) >= 2:\n        date_str = parts[0].strip()\n        price_str = parts[1].strip()\n        aapl_data.append({'Date': date_str, 'AAPL': float(price_str)})\n\ndf_aapl = pd.DataFrame(aapl_data)\n# Convert Date to datetime. \"Jan 2026\" needs format.\ndf_aapl['Date'] = pd.to_datetime(df_aapl['Date'], format='%b %Y') + pd.offsets.MonthEnd(0) # Align to month end\n\n# Processing S&P 500\nsp500_data = []\nfor line in sp500_text.strip().split('\\n'):\n    parts = line.split('|')\n    if len(parts) >= 2:\n        date_str = parts[0].strip()\n        price_str = parts[1].strip().replace(',', '')\n        sp500_data.append({'Date': date_str, 'SP500': float(price_str)})\n\ndf_sp500 = pd.DataFrame(sp500_data)\ndf_sp500['Date'] = pd.to_datetime(df_sp500['Date']) + pd.offsets.MonthEnd(0)\n\n# Merge\ndf_merged = pd.merge(df_aapl, df_sp500, on='Date', how='inner')\ndf_merged = df_merged.sort_values('Date')\n\n# Calculate Monthly Returns\ndf_merged['AAPL_Return'] = df_merged['AAPL'].pct_change()\ndf_merged['SP500_Return'] = df_merged['SP500'].pct_change()\n\n# Drop NaN (first row)\ndf_returns = df_merged.dropna()\n\n# CAPM Regression\n# y = AAPL_Return, x = SP500_Return\nslope, intercept, r_value, p_value, std_err = stats.linregress(df_returns['SP500_Return'], df_returns['AAPL_Return'])\n\nprint(f\"Beta: {slope}\")\nprint(f\"Alpha: {intercept}\")\nprint(f\"R-squared: {r_value**2}\")\n\n# Plotting AAPL Price\nplt.figure(figsize=(10, 6))\nplt.plot(df_merged['Date'], df_merged['AAPL'], label='AAPL Price')\nplt.title('Apple (AAPL) Stock Price - Last 5 Years')\nplt.xlabel('Date')\nplt.ylabel('Price ($)')\nplt.legend()\nplt.grid(True)\nplt.savefig('aapl_price_history.png')\n\n# Plotting Returns Relationship\nplt.figure(figsize=(8, 6))\nplt.scatter(df_returns['SP500_Return'], df_returns['AAPL_Return'], alpha=0.5)\nplt.plot(df_returns['SP500_Return'], intercept + slope * df_returns['SP500_Return'], 'r', label=f'Fit: y={slope:.2f}x + {intercept:.4f}')\nplt.title('Monthly Returns: AAPL vs S&P 500')\nplt.xlabel('S&P 500 Monthly Return')\nplt.ylabel('AAPL Monthly Return')\nplt.legend()\nplt.grid(True)\nplt.savefig('capm_regression.png')\n\n# Export to CSV\ndf_merged.to_csv('aapl_sp500_data.csv', index=False)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nBeta: 1.091504481063609\nAlpha: 0.001743016912168079\nR-squared: 0.4448837540235066\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-2-output-2.png){width=816 height=523}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-2-output-3.png){width=701 height=523}\n:::\n:::\n\n\nCute.\n\nAnd it matches.\n\n![Yahoo! Finance](./YFin.png)\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}